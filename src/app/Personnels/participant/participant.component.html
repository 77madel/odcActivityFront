<div class="p-12 bg-slate-100">
  <!-- Section des boutons -->
  <div class="flex gap-5 mb-2 justify-end">
    <!--<button class="bg-orange-400 text-white font-bold py-2 px-4 rounded " (click)="toggleForm()">
      Ajouter
    </button>-->
  </div>

  <div class="flex flex-col gap-2">
    <div class="flex gap-2 mb-2">
      <input type="text" [(ngModel)]="searchTerm" placeholder="Rechercher par nom ou prénom" class="p-1 border rounded flex-1 h-12" />

      <select [(ngModel)]="searchActivite" class="p-1 border rounded flex-1 h-12">
        <option value="">Choisir une activité</option>
        <option *ngFor="let activite of activites" [value]="activite.id">{{ activite.nom }}</option>
      </select>

      <select [(ngModel)]="searchEtape" class="p-1 border rounded flex-1 h-12" (change)="onEtapeChange()">
        <option value="">Choisir une étape</option>
        <option *ngFor="let etape of etape" [value]="etape.nom">{{ etape.nom }}</option>
      </select>

      <!-- Sélection de la liste visible uniquement si une étape est sélectionnée -->
      <select *ngIf="isEtapeSelected" [(ngModel)]="searchListType" class="p-1 border rounded flex-1 h-12">
        <option value="">Choisir une liste</option>
        <option value="listeDebut">Liste Début</option>
        <option value="listeResultat">Liste Résultat</option>
      </select>
    </div>
  </div>


  <!-- Table (affichée uniquement si isTableVisible est vrai) -->
  <div *ngIf="isTableVisible" class="border dark:border-inverse rounded-lg overflow-hidden p-10">
    <div class="overflow-x-auto">
      <table class="min-w-full bg-white border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-700">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Nom</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Prenom</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Email</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Téléphone</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Genre</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Activités</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase dark:text-gray-400">Check-in</th>
        </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700">
        <tr *ngFor="let element of paginatedParticipants" [ngClass]="{'bg-red-300': element.isBlacklisted}">
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">{{ element.nom }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">{{ element.prenom }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">{{ element.email }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">{{ element.phone }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">{{ element.genre }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">{{ element.activite.nom }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200">
            <input
              type="checkbox"
              (change)="onCheckInChange(element, $event)"
              [checked]="element.checkedIn"
              [disabled]="element.checkedIn" />
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <div class="flex justify-center mt-4">
      <button (click)="validateCheckIns()" class="bg-orange-400 hover:bg-orange-600 text-white font-bold py-2 px-3 rounded">
        Valider Check-ins
      </button>
    </div>

    <div *ngIf="participants && participants.length === 0" class="text-center mt-4">
      <p>Aucune donnée disponible pour le moment.</p>
    </div>
    <div class="flex justify-center mt-4">
      <button (click)="prevPage()" [disabled]="currentPage === 1" class="bg-orange-400 hover:bg-orange-500 text-white font-bold py-1 px-3 rounded">
        Précédent
      </button>
      <span class="mx-2">Page {{ currentPage }} sur {{ totalPages }}</span>
      <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="bg-orange-400 hover:bg-orange-500 text-white font-bold py-1 px-3 rounded">
        Suivant
      </button>
    </div>
  </div>
</div>
